

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chapel Evolution &mdash; Chapel Documentation 1.17</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  

  
    <link rel="top" title="Chapel Documentation 1.17" href="../index.html"/>
        <link rel="next" title="Archived Language Specifications" href="archivedSpecs.html"/>
        <link rel="prev" title="on-clauses: controlling locality/affinity" href="../users-guide/locality/onClauses.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

<a href="../index.html" class="icon icon-home"> Chapel Documentation</a>

<?php
// Variables given by sphinx
$chplTitle = "1.17";
$pagename = "language/evolution";
include "..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="spec.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Chapel Evolution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#version-1-15-april-2017">version 1.15, April 2017</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#array-lexical-scoping">array lexical scoping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#array-alias-operator-deprecated">array alias operator deprecated</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arrays-return-by-value-by-default">arrays return by value by default</a></li>
<li class="toctree-l3"><a class="reference internal" href="#array-default-intent">array default intent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#record-this-default-intent">record <cite>this</cite> default intent</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#version-1-13-april-2016">version 1.13, April 2016</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ref-return-intent">ref return intent</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#version-1-12-october-2015">version 1.12, October 2015</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lexical-scoping">lexical scoping</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#version-1-11-april-2015">version 1.11, April 2015</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#forall-intents">forall intents</a></li>
<li class="toctree-l3"><a class="reference internal" href="#type-select-statement">type select statement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#version-1-10-october-2014">version 1.10, October 2014</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-intents-syntax">task intents syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#var-function-return-intents-changed-to-ref">'var' function return intents changed to 'ref'</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#version-1-9-april-2014">version 1.9, April 2014</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#operator-precedence-changes-to-benefit-common-cases">operator precedence changes to benefit common cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#improved-interpretation-of-d">improved interpretation of {D}</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#version-1-8-october-2013">version 1.8, October 2013</a></li>
<li class="toctree-l2"><a class="reference internal" href="#version-1-6-october-2012">version 1.6, October 2012</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#domain-literals">domain literals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#zippered-iteration">zippered iteration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ignoring-tuple-components-underscore">ignoring tuple components/underscore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#version-1-4-october-2011">version 1.4, October 2011</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#function-declaration-keywords">function declaration keywords</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="archivedSpecs.html">Archived Language Specifications</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Chapel Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Chapel Evolution</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/language/evolution.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chapel-evolution">
<span id="id1"></span><h1>Chapel Evolution<a class="headerlink" href="#chapel-evolution" title="Permalink to this headline">¶</a></h1>
<p>Like any language, Chapel has changed over time. This page is designed to
capture significant language changes that have the possibility of breaking
existing user codes or code samples from old presentations or papers that
predated the changes.</p>
<div class="section" id="version-1-15-april-2017">
<h2>version 1.15, April 2017<a class="headerlink" href="#version-1-15-april-2017" title="Permalink to this headline">¶</a></h2>
<p>Version 1.15 includes several language changes to improve array semantics.</p>
<p>In summary:</p>
<blockquote>
<div><ul class="simple">
<li>arrays are always destroyed when they go out of scope and
in particular will not be preserved by use in <cite>begin</cite>.
See <a class="reference internal" href="#readme-evolution-array-lexical-scoping"><span>array lexical scoping</span></a>.</li>
<li>the array alias operator <cite>=&gt;</cite> has been deprecated in favor of creating
references to an array or a slice of an array with <cite>ref</cite> or <cite>const ref</cite>.
See <a class="reference internal" href="#readme-evolution-alias-operator-deprecated"><span>array alias operator deprecated</span></a>.</li>
<li>arrays now return by value by default instead of by <cite>ref</cite>.
See <a class="reference internal" href="#readme-evolution-arrays-return-by-value"><span>arrays return by value by default</span></a>.</li>
<li>arrays now pass by <cite>ref</cite> or <cite>const ref</cite> by default, depending on
whether or not the formal argument is modified.
See <a class="reference internal" href="#readme-evolution-array-default-intent"><span>array default intent</span></a>.</li>
</ul>
</div></blockquote>
<p>Additionally, the default intent for record method receivers has changed:</p>
<blockquote>
<div><ul class="simple">
<li>the method receiver for records is passed by <cite>ref</cite> or <cite>const ref</cite> by
default, depending on whether or not the formal argument is modified.
See <a class="reference internal" href="#readme-evolution-record-this-default-intent"><span>record this default intent</span></a>.</li>
</ul>
</div></blockquote>
<div class="section" id="array-lexical-scoping">
<span id="readme-evolution-array-lexical-scoping"></span><h3>array lexical scoping<a class="headerlink" href="#array-lexical-scoping" title="Permalink to this headline">¶</a></h3>
<p>As described in the language changes for 1.12 in
<a class="reference internal" href="#readme-evolution-lexical-scoping"><span>lexical scoping</span></a>, using arrays beyond their scope
is a user error. While such a program was in error starting with Chapel
1.12, such a pattern worked until Chapel 1.15.</p>
<p>For example, this program will probably crash in Chapel 1.15:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">proc</span> <span class="nf">badBegin</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">A</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10000</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
  <span class="k">begin</span> <span class="p">{</span>
    <span class="nx">A</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// Error: A destroyed here at function end, but the begin could still</span>
  <span class="c1">// be using it!</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Similarly, using a slice after an array has been destroyed is an error:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">proc</span> <span class="nf">badBeginSlice</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">A</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10000</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
  <span class="c1">// slice1 sets up a slice using the =&gt; operator</span>
  <span class="c1">// note that the =&gt; operator is deprecated (see below)</span>
  <span class="kd">var</span> <span class="nx">slice1</span> <span class="o">=&gt;</span> <span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">1000</span><span class="p">];</span>
  <span class="c1">// slice2 sets up a slice by creating a reference to it</span>
  <span class="kd">ref</span> <span class="nx">slice2</span> <span class="o">=</span> <span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">1000</span><span class="p">];</span>
  <span class="c1">// either way, using the slice in a begin that can continue</span>
  <span class="c1">// after the function declaring the array exits is an error</span>
  <span class="k">begin</span> <span class="p">{</span>
    <span class="nx">slice1</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">slice2</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// Error: A destroyed here at function end, but the begin tries to</span>
  <span class="c1">// use it through the slices!</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="array-alias-operator-deprecated">
<span id="readme-evolution-alias-operator-deprecated"></span><h3>array alias operator deprecated<a class="headerlink" href="#array-alias-operator-deprecated" title="Permalink to this headline">¶</a></h3>
<p>The array alias operator, <cite>=&gt;</cite>, has been deprecated in Chapel 1.15.
Previously, the supported way to declare one array that aliases another
(or a slice of another) was to use <cite>=&gt;</cite>. Now, the supported way to do
that is to use a <cite>ref</cite> or <cite>const ref</cite> variable:</p>
<p>For example, before Chapel 1.15 you might have written:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="c1">// pre-1.15</span>
<span class="kd">var</span> <span class="nx">A</span><span class="p">:[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
<span class="c1">// set up a const alias of A</span>
<span class="kd">const</span> <span class="nx">alias</span> <span class="o">=&gt;</span> <span class="nx">A</span><span class="p">;</span>
<span class="c1">// set up a mutable slice of A</span>
<span class="kd">var</span> <span class="nx">slice</span> <span class="o">=&gt;</span> <span class="nx">A</span><span class="p">[</span><span class="mi">2</span><span class="o">..</span><span class="mi">5</span><span class="p">];</span>
<span class="c1">// set up a re-indexing slice of A</span>
<span class="kd">var</span> <span class="nx">reindex</span><span class="p">:[</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="nx">A</span><span class="p">;</span>
</pre></div>
</div>
<p>In Chapel 1.15, use <cite>ref</cite> or <cite>const ref</cite> to create the same pattern:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">A</span><span class="p">:[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
<span class="c1">// set up a const alias of A</span>
<span class="kd">const</span> <span class="kd">ref</span> <span class="nx">alias</span> <span class="o">=</span> <span class="nx">A</span><span class="p">;</span>
<span class="c1">// set up a mutable slice of A</span>
<span class="kd">ref</span> <span class="nx">slice</span> <span class="o">=</span> <span class="nx">A</span><span class="p">[</span><span class="mi">2</span><span class="o">..</span><span class="mi">5</span><span class="p">];</span>
<span class="c1">// set up a re-indexing slice of A</span>
<span class="kd">ref</span> <span class="nx">reindex</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">reindex</span><span class="p">({</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="arrays-return-by-value-by-default">
<span id="readme-evolution-arrays-return-by-value"></span><h3>arrays return by value by default<a class="headerlink" href="#arrays-return-by-value-by-default" title="Permalink to this headline">¶</a></h3>
<p>Before Chapel 1.15, returning an array would return the array by
reference. Now arrays return by value by default. That is, the act of
returning an array can make a copy:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">A</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">4</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
<span class="k">proc</span> <span class="nf">returnsArray</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">A</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">ref</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">returnsArray</span><span class="p">();</span>
<span class="nx">B</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span>
<span class="c1">// outputs 1 1 1 1 historically</span>
<span class="c1">// outputs 0 0 0 0 after Chapel 1.15</span>
</pre></div>
</div>
<p>This behavior applies to array slices as well.</p>
<p>The old behavior is available with the <cite>ref</cite> return intent. Note though that
returning a <cite>ref</cite> to a local array is an error just like it is an error to
return a local <cite>int</cite> variable by <cite>ref</cite>.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">proc</span> <span class="nf">returnsArrayReference</span><span class="p">()</span> <span class="kd">ref</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">A</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="array-default-intent">
<span id="readme-evolution-array-default-intent"></span><h3>array default intent<a class="headerlink" href="#array-default-intent" title="Permalink to this headline">¶</a></h3>
<p>Before 1.15, the default intent for arrays was <cite>ref</cite>. The rationale for
this feature was that it was a convenience for programmers who are used
to modifying array formal arguments in their functions. Unfortunately, it
interacted poorly with return intent overloading.
Additionally, the implementation had several bugs in this area.</p>
<p>The following example shows how it might be surprising that return intent
overloading behaves very differently for arrays than for other types. As
the example shows, this issue affects program behavior and not just
const-checking error messages from the compiler.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="c1">// First, let&#39;s try some of these things with an</span>
<span class="c1">// associative array of ints:</span>
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">D</span><span class="p">:</span><span class="k">domain</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">A</span><span class="p">:[</span><span class="nx">D</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>

  <span class="c1">// This adds index 1 to the domain, implicitly</span>
  <span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">member</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span> <span class="c1">// outputs `true`</span>

  <span class="c1">// This will halt, because index 2 is not in the domain</span>
  <span class="c1">//var tmp = A[2];</span>

  <span class="c1">// This will also halt, for the same reason</span>
  <span class="c1">//writeln(A[3]);</span>
<span class="p">}</span>

<span class="c1">// Now, let&#39;s try the same things with an array of arrays:</span>
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">D</span><span class="p">:</span><span class="k">domain</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">AA</span><span class="p">:[</span><span class="nx">D</span><span class="p">]</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">4</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">value</span><span class="p">:[</span><span class="mi">1</span><span class="o">..</span><span class="mi">4</span><span class="p">]</span> <span class="kt">int</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">];</span>

  <span class="c1">// This adds index 4 to the domain, implicitly</span>
  <span class="nx">AA</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">member</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span> <span class="c1">// outputs `true`</span>

  <span class="c1">// This will halt, because index 5 is not in the domain</span>
  <span class="c1">//var tmp = AA[5];</span>

  <span class="c1">// It seems that this *should* halt, but it does not (pre 1.15)</span>
  <span class="c1">// Instead, it adds index 6 to the domain</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">AA</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">member</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span> <span class="c1">// outputs `true` !</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See GitHub issue #5217 for more examples and discussion.</p>
<p>In order to make such programs less surprising, version 1.15 changes the default
intent for arrays to <cite>ref</cite> if the formal argument is modified in the function
and <cite>const ref</cite> if not. As a result, the above example behaves similarly for an
associative array of integers and an associative array of dense arrays.</p>
<p>For example, in the following program, the default intent for the formal
argument <cite>x</cite> is <cite>ref</cite>:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">proc</span> <span class="nf">setElementOne</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// x is modified, so x has ref intent</span>
  <span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">A</span><span class="p">:[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
<span class="nx">setElementOne</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span>
</pre></div>
</div>
<p>In contrast, in the following program, the default intent for the formal argument <cite>y</cite> is <cite>const ref</cite>:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">proc</span> <span class="nf">getElementOne</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// y is not modified, so y has const ref intent</span>
  <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">y</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">B</span><span class="p">:[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
<span class="nx">getElementOne</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="record-this-default-intent">
<span id="readme-evolution-record-this-default-intent"></span><h3>record <cite>this</cite> default intent<a class="headerlink" href="#record-this-default-intent" title="Permalink to this headline">¶</a></h3>
<p>Before 1.15, the default intent for the implicit <cite>this</cite> argument for
record methods was implemented as <cite>ref</cite> but specified as <cite>const ref</cite>. In
1.15, this changed to <cite>ref</cite> if the formal <cite>this</cite> argument is modified in
the body of the function and <cite>const ref</cite> if not.</p>
<p>See GitHub issue #5266 for more details and discussion.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="nc">R</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">field</span><span class="p">:</span> <span class="kt">int</span><span class="p">;</span>

  <span class="k">proc</span> <span class="nf">setFieldToOne</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// this is modified, so this-intent is ref</span>
    <span class="nx">this</span><span class="p">.</span><span class="nx">field</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">proc</span> <span class="nf">printField</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// this is not modified, so this-intent is const ref</span>
    <span class="nx">writeln</span><span class="p">(</span><span class="nx">this</span><span class="p">.</span><span class="nx">field</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="version-1-13-april-2016">
<h2>version 1.13, April 2016<a class="headerlink" href="#version-1-13-april-2016" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ref-return-intent">
<h3>ref return intent<a class="headerlink" href="#ref-return-intent" title="Permalink to this headline">¶</a></h3>
<p>Previous versions of Chapel included an implicit <cite>setter</cite> param of
type <cite>bool</cite> for <cite>ref</cite> return intent functions. In addition, the compiler
created a getter and setter version of each ref return intent function.
The getter version would return an rvalue, and the setter version would
return an lvalue by ref. For example:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="k">proc</span> <span class="nf">refToX</span><span class="p">()</span> <span class="kd">ref</span> <span class="p">{</span>
  <span class="k">if</span> <span class="nx">setter</span> <span class="k">then</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">;</span> <span class="c1">// setter version</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// getter version</span>
<span class="p">}</span>

<span class="nx">refToX</span><span class="p">()</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>       <span class="c1">// uses the setter version</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>         <span class="c1">// prints 3</span>
<span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">refToX</span><span class="p">();</span> <span class="c1">// uses the getter version</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">tmp</span><span class="p">);</span>       <span class="c1">// prints 0</span>
</pre></div>
</div>
<p>This functionality has changed with version 1.13. It is still possible to
write a getter and a setter, but these must be written as pair of
related functions:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// setter version</span>
<span class="k">proc</span> <span class="nf">refToX</span><span class="p">()</span> <span class="kd">ref</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// getter version</span>
<span class="k">proc</span> <span class="nf">refToX</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">refToX</span><span class="p">()</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>       <span class="c1">// uses the setter version</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>         <span class="c1">// prints 3</span>
<span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">refToX</span><span class="p">();</span> <span class="c1">// uses the getter version</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">tmp</span><span class="p">);</span>       <span class="c1">// prints 0</span>
</pre></div>
</div>
<p>In some cases, when migrating code over to the new functionality,
it is useful to put the old ref return intent function into a
helper function with an explicit param <cite>setter</cite> argument, and then to
call that function from the getter or setter.</p>
</div>
</div>
<div class="section" id="version-1-12-october-2015">
<h2>version 1.12, October 2015<a class="headerlink" href="#version-1-12-october-2015" title="Permalink to this headline">¶</a></h2>
<div class="section" id="lexical-scoping">
<span id="readme-evolution-lexical-scoping"></span><h3>lexical scoping<a class="headerlink" href="#lexical-scoping" title="Permalink to this headline">¶</a></h3>
<p>Prior to version 1.12 of Chapel, variables could be kept alive past
their lexical scopes. For example:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="kd">var</span> <span class="nx">A</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="nx">n</span><span class="p">]</span> <span class="kt">real</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">count$</span><span class="p">:</span> <span class="k">sync</span> <span class="kt">int</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">x</span><span class="p">:</span> <span class="kt">real</span><span class="p">;</span>
  <span class="k">begin</span> <span class="k">with</span> <span class="p">(</span><span class="kd">ref</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">..</span><span class="p">.</span> <span class="nx">A</span> <span class="o">..</span><span class="p">.;</span>
    <span class="o">..</span><span class="p">.</span> <span class="nx">count$</span> <span class="o">..</span><span class="p">.;</span>
    <span class="o">..</span><span class="p">.</span> <span class="nx">x</span> <span class="o">..</span><span class="p">.;</span>
  <span class="p">}</span>
  <span class="c1">// ^^^ this task and its references to A, count$, and x could outlive</span>
  <span class="c1">// the scope in which those variables are declared.</span>
<span class="p">}</span> <span class="c1">// So, previously, Chapel kept these variables alive past their</span>
  <span class="c1">// logical scope.</span>
</pre></div>
</div>
<p>Disadvantages of this approach included:</p>
<blockquote>
<div><ul class="simple">
<li>It moves logical stack variables (like <cite>x</cite> and <cite>count$</cite> above) to
the heap.</li>
<li>It complicates memory management by incurring reference counting
overhead---or causing memory leaks in cases where reference
counting hadn't been added.</li>
<li>It was not particularly valued or utilized by users.</li>
<li>It was arguably surprising (&quot;x still exists even though it left
scope?&quot;).</li>
</ul>
</div></blockquote>
<p>As of Chapel 1.12 (and moreso in subsequent releases), the
implementation no longer provides this property. Instead, it is a user
error to refer to a variable after it has left scope. For example:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">flag$</span><span class="p">:</span> <span class="k">sync</span> <span class="kt">bool</span><span class="p">;</span> <span class="c1">// flag$ starts empty</span>
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">x</span><span class="p">:</span> <span class="kt">real</span><span class="p">;</span>
  <span class="k">begin</span> <span class="k">with</span><span class="p">(</span><span class="kd">ref</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// create task referring to x</span>
    <span class="nx">flag$</span><span class="p">;</span>            <span class="c1">// block task until flag$ is full</span>
    <span class="o">..</span><span class="p">.</span> <span class="nx">x</span> <span class="o">..</span><span class="p">.</span>         <span class="c1">// user error: access to x occurs after it leaves scope</span>
  <span class="p">}</span>                   <span class="c1">// end task</span>
<span class="p">}</span>                     <span class="c1">// x`s scope ends</span>
<span class="nx">flag$</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>         <span class="c1">// fill flag$ only after x&#39;s scope closes</span>
</pre></div>
</div>
<p>Code that refers to lexically scoped variables within tasks in this manner
should use <cite>sync</cite> variables or blocks in order to guarantee the
tasks's completion before the enclosing block exits. Note that the
more commonly used <cite>cobegin</cite>, <cite>coforall</cite>, and <cite>forall</cite> statements
already guarantee that the tasks they create will complete before the
enclosing block exits.</p>
</div>
</div>
<div class="section" id="version-1-11-april-2015">
<h2>version 1.11, April 2015<a class="headerlink" href="#version-1-11-april-2015" title="Permalink to this headline">¶</a></h2>
<div class="section" id="forall-intents">
<h3>forall intents<a class="headerlink" href="#forall-intents" title="Permalink to this headline">¶</a></h3>
<p>In previous versions of Chapel, the bodies of forall-loops have referred to
all lexically visible variables by reference. In this release of Chapel, such
variables are treated more consistently with the task intent semantics and
syntax introduced in versions 1.8 and 1.10 respectively (described below).</p>
<p>Specifically, prior to this release, a loop like the following would
represent a data race:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="k">forall</span> <span class="nx">a</span> <span class="kd">in</span> <span class="nx">A</span> <span class="k">do</span> <span class="nx">sum</span> <span class="o">+=</span> <span class="nx">a</span><span class="p">;</span>
</pre></div>
</div>
<p>since multiple iterations of the loop could execute simultaneously, read
the identical value from the shared variable <code class="docutils literal"><span class="pre">sum</span></code>, update it, and write the
result back in a way that could overwrite other simultaneous updates.</p>
<p>Under the new forall intent semantics, such variables are treated as though
they are passed by &quot;blank intent&quot; to the loop body (so <code class="docutils literal"><span class="pre">const</span></code> for variables of
scalar type like <code class="docutils literal"><span class="pre">sum</span></code>, preventing races in such cases). This mirrors the task
intent semantics for variables referenced within begin, <code class="docutils literal"><span class="pre">cobegin</span></code>, and <code class="docutils literal"><span class="pre">coforall</span></code>
constructs. As in those cases, a user can specify semantics other than the
default via a <em>with-clause</em>. For example, to restore the previous race-y
semantics, one could write:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="k">forall</span> <span class="nx">a</span> <span class="kd">in</span> <span class="nx">A</span> <span class="k">with</span> <span class="p">(</span><span class="kd">ref</span> <span class="nx">sum</span><span class="p">)</span> <span class="k">do</span>
  <span class="nx">sum</span> <span class="o">+=</span> <span class="nx">a</span><span class="p">;</span>
</pre></div>
</div>
<p>(Of course, the safe way to write such an idiom would be to use a
reduction, or a synchronization type like <code class="docutils literal"><span class="pre">sync</span></code> or <code class="docutils literal"><span class="pre">atomic</span></code>).</p>
</div>
<div class="section" id="type-select-statement">
<h3>type select statement<a class="headerlink" href="#type-select-statement" title="Permalink to this headline">¶</a></h3>
<p>Chapel has traditionally supported a <code class="docutils literal"><span class="pre">type</span> <span class="pre">select</span></code> statement that was
like a <code class="docutils literal"><span class="pre">select</span></code> statement for types. However, this seemed inconsistent with the
fact that other constructs like <code class="docutils literal"><span class="pre">if...then</span></code> operate on types directly. For that
reason, this release removed support for <code class="docutils literal"><span class="pre">type</span> <span class="pre">select</span> <span class="pre">x</span></code>. Instead, use the
equivalent <code class="docutils literal"><span class="pre">select</span> <span class="pre">x.type</span></code>.</p>
</div>
</div>
<div class="section" id="version-1-10-october-2014">
<h2>version 1.10, October 2014<a class="headerlink" href="#version-1-10-october-2014" title="Permalink to this headline">¶</a></h2>
<div class="section" id="task-intents-syntax">
<h3>task intents syntax<a class="headerlink" href="#task-intents-syntax" title="Permalink to this headline">¶</a></h3>
<p>Task intent clauses were added to Chapel in version 1.8 to
support passing variables by reference into tasks. Since then, the need to pass
variables by other intents and into other parallel constructs has arisen. But,
the previous syntax was problematic to extend to other intents, while also
generating syntactic ambiguities for other additions we wished to make to the
language.</p>
<p>For these reasons, a new task intent syntax was designed to cleanly support
intents other than <code class="docutils literal"><span class="pre">ref</span></code> (particularly in looping contexts), to address the
pending ambiguity, and to better reflect the similarity of task intents to
formal argument lists. Where previously, task constructs could be followed by a
<code class="docutils literal"><span class="pre">ref</span></code> clause, they can now be followed by a <code class="docutils literal"><span class="pre">with</span></code> clause that takes a list of
intents and variables, specifying how to pass them into the task.</p>
<p>Thus, where one would have previously written:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">begin</span> <span class="kd">ref</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="nx">update</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>

<span class="k">cobegin</span> <span class="kd">ref</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">process</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="nx">process</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">coforall</span> <span class="nx">x</span> <span class="kd">in</span> <span class="nx">A</span> <span class="kd">ref</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">process</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>you would now write:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">begin</span> <span class="k">with</span> <span class="p">(</span><span class="kd">ref</span> <span class="nx">x</span><span class="p">)</span> <span class="nx">update</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>

<span class="k">cobegin</span> <span class="k">with</span><span class="p">(</span><span class="kd">ref</span> <span class="nx">x</span><span class="p">,</span> <span class="kd">ref</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">process</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="nx">process</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">coforall</span> <span class="nx">x</span> <span class="kd">in</span> <span class="nx">A</span> <span class="k">with</span> <span class="p">(</span><span class="kd">ref</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">process</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As of the 1.10 release, only <code class="docutils literal"><span class="pre">ref</span></code> intents are supported, though we plan to
expand this set of intents for the 1.11 release while also extending
forall-loops to support task intents.</p>
</div>
<div class="section" id="var-function-return-intents-changed-to-ref">
<h3>'var' function return intents changed to 'ref'<a class="headerlink" href="#var-function-return-intents-changed-to-ref" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal"><span class="pre">var</span></code> function return intent has traditionally been used to indicate that
a call to the function (referred to as a <em>var function</em>) could appear in either
an r-value or l-value context. The <code class="docutils literal"><span class="pre">var</span></code> keyword was chosen since the function
could be used in the same contexts as a variable could.</p>
<p>Since that time, the <code class="docutils literal"><span class="pre">ref</span></code> keyword has been introduced into Chapel to
support passing variables by reference to functions. Since returning an
expression by reference supports similar capabilities as <code class="docutils literal"><span class="pre">var</span></code> functions require,
while also being less unusual/more orthogonal, this release replaces <code class="docutils literal"><span class="pre">var</span></code>
function return intents with <code class="docutils literal"><span class="pre">ref</span></code> intents.</p>
<p>Thus, where one would previously write:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">proc</span> <span class="nf">getFoo</span><span class="p">()</span> <span class="kd">var</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
</pre></div>
</div>
<p>now you would write:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">proc</span> <span class="nf">getFoo</span><span class="p">()</span> <span class="kd">ref</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">var</span></code> as a return intent is deprecated and generates a warning for the
current release, after which it will be removed.</p>
</div>
</div>
<div class="section" id="version-1-9-april-2014">
<h2>version 1.9, April 2014<a class="headerlink" href="#version-1-9-april-2014" title="Permalink to this headline">¶</a></h2>
<div class="section" id="operator-precedence-changes-to-benefit-common-cases">
<h3>operator precedence changes to benefit common cases<a class="headerlink" href="#operator-precedence-changes-to-benefit-common-cases" title="Permalink to this headline">¶</a></h3>
<p>Historically, Chapel's operator precedence choices have tended to follow the
lead of C for operators that are common to both languages, figuring that
following an established convention would be better than forging our own path.</p>
<p>With this change, we modified the precedence of bitwise operators to better
reflect what we think it intuitive to users and correct what is viewed in many
circles to be a regrettable mistake in C. At the same time, we changed the
binding of <code class="docutils literal"><span class="pre">in</span></code> and <code class="docutils literal"><span class="pre">..</span></code> to support some other Chapel idioms more naturally,
like <code class="docutils literal"><span class="pre">1..10</span> <span class="pre">==</span> <span class="pre">1..10</span></code>. To see the current operator precedence, refer to the
:download:Quick Reference &lt;https://chapel-lang.org/spec/quickReference.pdf&gt; sheet.</p>
</div>
<div class="section" id="improved-interpretation-of-d">
<h3>improved interpretation of {D}<a class="headerlink" href="#improved-interpretation-of-d" title="Permalink to this headline">¶</a></h3>
<p>Historically, for a domain D, Chapel has interpreted <code class="docutils literal"><span class="pre">{D}</span></code> as being equivalent to
<code class="docutils literal"><span class="pre">D</span></code>, inheriting a precedent of sorts set by the ZPL language, and dating from a
time when we used square brackets for both domain literals and array types.</p>
<p>With this change, we began interpreting <code class="docutils literal"><span class="pre">{D}</span></code> as a domain literal with a
single index, <code class="docutils literal"><span class="pre">D</span></code> (i.e., an associative domain of domains). Associative domains
of domains are not yet implemented in the language, so the new syntax is not
yet useful, but at least the incongruity of ignoring the curly brackets has
been removed.</p>
</div>
</div>
<div class="section" id="version-1-8-october-2013">
<h2>version 1.8, October 2013<a class="headerlink" href="#version-1-8-october-2013" title="Permalink to this headline">¶</a></h2>
<p>task functions and intents; ref-clauses Chapel has three constructs for
creating tasks: <code class="docutils literal"><span class="pre">begin</span></code>, <code class="docutils literal"><span class="pre">cobegin</span></code>, and <code class="docutils literal"><span class="pre">coforall</span></code>. Historically, variable references
within tasks followed standard lexical scoping rules. For example, the
following code:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">begin</span> <span class="nx">writeln</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="nx">x</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
<p>could print either the value 0 or 1, depending on whether the <code class="docutils literal"><span class="pre">writeln()</span></code>
task was executed before or after the increment of <code class="docutils literal"><span class="pre">x</span></code>.</p>
<p>With this change, we view the creation of a task as an invocation of a <em>task function</em>
— a compiler-created function that implements the task. Any references
to variables outside of the task's scope (like <code class="docutils literal"><span class="pre">x</span></code> in the example above) are
treated as implicit arguments to the task function, passed by blank intent.</p>
<p>Thus, when <code class="docutils literal"><span class="pre">x</span></code> is an integer, as in the above code, the task will always
print the value of 0, even if the increment of <code class="docutils literal"><span class="pre">x</span></code> is executed before the
<code class="docutils literal"><span class="pre">writeln()</span></code> task, since the value of <code class="docutils literal"><span class="pre">x</span></code> will have been passed to the task function
by blank intent (implying a <code class="docutils literal"><span class="pre">const</span></code> copy for integer arguments). In contrast, if
x were a sync variable in the example above, the blank intent would cause it to
be passed by reference to the task, permitting the task to see either of the
values 0 or 1.</p>
<p>To return to the previous behavior, a <em>ref-clause</em> can be added to the
tasking construct to indicate that a variable should be passed to the task
function by reference rather than blank intent. For example, the following
code:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">begin</span> <span class="kd">ref</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="nx">writeln</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="nx">x</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
<p>would revert to the previous behavior, even if <code class="docutils literal"><span class="pre">x</span></code> were an integer.</p>
<p>For more information on this feature, please refer to the <em>Task Intents</em>
section of the <em>Task Parallelism</em> and <em>Synchronization</em> chapter of the language
specification.</p>
</div>
<div class="section" id="version-1-6-october-2012">
<h2>version 1.6, October 2012<a class="headerlink" href="#version-1-6-october-2012" title="Permalink to this headline">¶</a></h2>
<div class="section" id="domain-literals">
<h3>domain literals<a class="headerlink" href="#domain-literals" title="Permalink to this headline">¶</a></h3>
<p>Chapel's domain literals were historically specified using
square brackets, based on ZPL's region syntax. Thus <code class="docutils literal"><span class="pre">[1..m,</span> <span class="pre">1..n]</span></code> represented an
<em>m × n</em> index set.</p>
<p>In this change, we made domain literals use curly brackets in order to
reflect their role as sets of indices, and also to make square brackets
available for supporting array literals. Thus, <code class="docutils literal"><span class="pre">{1..m,</span> <span class="pre">1..n}</span></code> is an <em>m × n</em> index
set, <code class="docutils literal"><span class="pre">[1.2,</span> <span class="pre">3.4,</span> <span class="pre">5.6]</span></code> is a 3-element array of reals and <code class="docutils literal"><span class="pre">[1..m,</span> <span class="pre">1..n]</span></code> is a
2-element array of ranges.</p>
<p>Emacs users working on updating existing code can use the following recipe
to update old-style domain literals to the new syntax:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>M-x query-replace-regexp: \([=|,] *\)\[\(.*?\)\]\([;|)]\)
with: \1{\2}\3
</pre></div>
</div>
</div>
<div class="section" id="zippered-iteration">
<h3>zippered iteration<a class="headerlink" href="#zippered-iteration" title="Permalink to this headline">¶</a></h3>
<p>Zippered iteration in Chapel was traditionally supported
simply by iterating over a tuple of values. For example, forall <code class="docutils literal"><span class="pre">(i,a)</span></code> in
<code class="docutils literal"><span class="pre">(1..n,</span> <span class="pre">A)</span></code> would iterate over the range <code class="docutils literal"><span class="pre">1..n</span></code> and the n-element array
<code class="docutils literal"><span class="pre">A</span></code> in a zippered manner.</p>
<p>In this change, we introduced the zip keyword to make these zippered
iterations more explicit and to permit iteration over a tuple's values
directly. Thus, the zippered iteration above would now be written:</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">forall</span> <span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">a</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="nx">n</span><span class="p">,</span> <span class="nx">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ignoring-tuple-components-underscore">
<h3>ignoring tuple components/underscore<a class="headerlink" href="#ignoring-tuple-components-underscore" title="Permalink to this headline">¶</a></h3>
<p>Overtime, the mechanism used to ignore a tuple component when destructuring a tuple
has changed.
Originally, an underscore was used to drop a value on the floor. For example,
given a 3-tuple <code class="docutils literal"><span class="pre">t</span></code>, the first and last components could be stored in <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">z</span></code>,
dropping the second component on the floor using: <code class="docutils literal"><span class="pre">var</span> <span class="pre">(x,</span> <span class="pre">_,</span> <span class="pre">z)</span> <span class="pre">=</span> <span class="pre">t;</span></code>.
In version 1.1 (Apr 2010), we changed this to use a blank space instead of an
underscore, for simplicity and to permit underscore to be used as an identifier
name. Thus, the example above would have been written as <code class="docutils literal"><span class="pre">var</span> <span class="pre">(x,</span> <span class="pre">,</span> <span class="pre">z)</span> <span class="pre">=</span> <span class="pre">t;</span></code>
during this time period.</p>
<p>However, in 2012, we changed back to using the underscore again in order to
support the specification of 1-tuples using a dangling comma, similar to
Python. Thus, dropping a tuple component is expressed as <code class="docutils literal"><span class="pre">var</span> <span class="pre">(x,</span> <span class="pre">_,</span> <span class="pre">z)</span> <span class="pre">=</span> <span class="pre">t;</span></code>
again while <code class="docutils literal"><span class="pre">(1.2,</span> <span class="pre">)</span></code> is a 1-tuple of reals.</p>
</div>
</div>
<div class="section" id="version-1-4-october-2011">
<h2>version 1.4, October 2011<a class="headerlink" href="#version-1-4-october-2011" title="Permalink to this headline">¶</a></h2>
<div class="section" id="function-declaration-keywords">
<h3>function declaration keywords<a class="headerlink" href="#function-declaration-keywords" title="Permalink to this headline">¶</a></h3>
<p>Prior to this change, the keyword <code class="docutils literal"><span class="pre">def</span></code> was used to
define both procedures and iterators; the compiler inspected the body of the
function for yield statements to determine whether it was a procedure or an
iterator.</p>
<p>In this change, we introduced the <code class="docutils literal"><span class="pre">proc</span></code> and <code class="docutils literal"><span class="pre">iter</span></code> keywords to distinguish
between these two cases for the sake of clarity, to avoid mistakes, to support
semantics that clearly distinguish between these cases, and to better support
specifying interfaces.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="archivedSpecs.html" class="btn btn-neutral float-right" title="Archived Language Specifications" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../users-guide/locality/onClauses.html" class="btn btn-neutral" title="on-clauses: controlling locality/affinity" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Cray Inc.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.17.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 



</body>
</html>